# Sofia Memory Plugin

## –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

Sofia Memory Plugin —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Å–ª–æ–π –¥–ª—è LLM- –∏–ª–∏ –¥–µ—Å–∫—Ç–æ–ø-–∞–≥–µ–Ω—Ç–∞: –¥–æ—Å—Ç—É–ø –∫ –ø–∞–º—è—Ç–∏ –∏–¥—ë—Ç —á–µ—Ä–µ–∑ REST API –ø–ª–∞–≥–∏–Ω–∞, –∞ —Å–∞–º–∏ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–µ –∏–ª–∏ GitHub-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

–ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∏ –±–∞–∑–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π: ¬´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç LLM —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∑–∞–º–µ—Ç–∫–∏ –æ –ø—Ä–æ–µ–∫—Ç–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏–ª–∏ –≤ GitHub, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –ø–æ–¥–º–µ—à–∏–≤–∞—Ç—å –∏—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–æ–≤¬ª.

–ü–æ—Ç–æ–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí LLM ‚Üí –ü–ª–∞–≥–∏–Ω –ø–∞–º—è—Ç–∏ ‚Üí –§–∞–π–ª—ã/GitHub ‚Üí LLM (–∫–æ–Ω—Ç–µ–∫—Å—Ç)
```

Sofia Memory Plugin \u2014 —ç—Ç–æ –Ω–µ–±–æ–ª—å—à–æ–π —Å–µ—Ä–≤–∏—Å –Ω–∞ Node.js, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π REST API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏ –ø–∞–º—è—Ç–∏ –∏ –ø–ª–∞–Ω–∞–º–∏ –æ–±—É—á–µ–Ω–∏—è. –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è –ø—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–º—è—Ç–∏, –Ω–∞–±–æ—Ä —É—Ç–∏–ª–∏—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ Markdown –∏ —Ç–µ—Å—Ç—ã.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- npm 8+

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö

- **–ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–∫–µ–Ω—ã:** OAuth-—Ç–æ–∫–µ–Ω—ã GitHub —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `tools/.cache/tokens/<userId>.txt`; –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ë–î —Å —Ç–æ–π –∂–µ —Å—Ö–µ–º–æ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.
- **–§–æ—Ä–º–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è:** –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω —à–∏—Ñ—Ä—É–µ—Ç—Å—è –∫–ª—é—á–æ–º –∏–∑ `TOKEN_SECRET` (–∞–ª–≥–æ—Ä–∏—Ç–º AES-256-CBC), –ø–æ—ç—Ç–æ–º—É —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É.
- **–ó–∞–ø—Ä–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:** –≤ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ª–æ–≥–∞—Ö –Ω–µ–ª—å–∑—è –ø–µ—á–∞—Ç–∞—Ç—å —Å–∞–º–∏ —Ç–æ–∫–µ–Ω—ã, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã GitHub —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤. –õ–æ–≥–∏—Ä—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –∫–æ–¥—ã –∏ –∫—Ä–∞—Ç–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã –∑–∞–ø—Ä–æ—Å–æ–≤.
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:** —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω GitHub —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –ø–ª–∞–≥–∏–Ω–∞ –∏ –≤—ã–¥–∞–≤–∞–π—Ç–µ –µ–º—É –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞). –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–∫–µ–Ω –∞–∫–∫–∞—É–Ω—Ç–∞ –∏–ª–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã —Å –∏–∑–±—ã—Ç–æ—á–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   npm install
   ```
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
   ```bash
   npm start
   ```
   –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç `10000`.
   –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –æ—Ç–≤–µ—Ç—ã GitHub (–∫–æ–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ), —á—Ç–æ –æ–±–ª–µ–≥—á–∞–µ—Ç
   –ø–æ–∏—Å–∫ –ø—Ä–∏—á–∏–Ω –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º.

–î–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª `.env` (—Å–º. `.env.example`) –∏–ª–∏ `config/config.json`, –≥–¥–µ –∑–∞–¥–∞—é—Ç—Å—è URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ —Ç–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `TOKEN_SECRET` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤.

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å LLM-–∞–≥–µ–Ω—Ç–æ–º

–¢–∏–ø–æ–≤–æ–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ —Å –ø–ª–∞–≥–∏–Ω–æ–º –ø–∞–º—è—Ç–∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ç—ã—Ä—ë—Ö —à–∞–≥–æ–≤:

1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏ –∑–∞–ø—Ä–æ—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.** –ê–≥–µ–Ω—Ç –≤—ã–¥–µ–ª—è–µ—Ç –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ 3‚Äì7 –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–∑, –ø–æ–¥–±–∏—Ä–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ `getContextFilesForKeywords` –∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—ã–∑–æ–≤–æ–º `POST /api/memory/context` (—Å–∏–Ω–æ–Ω–∏–º `POST /api/memory/load-to-context`) –∏–ª–∏ –ø—Ä—è–º—ã–º —á—Ç–µ–Ω–∏–µ–º `POST /api/memory/read`.
2. **–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ —Å –±–ª–æ–∫–æ–º `memory_to_save`.** LLM —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç `memory_to_save` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–æ–≤–∞—è –∑–∞–º–µ—Ç–∫–∞ –∏–ª–∏ —É—Ç–æ—á–Ω—ë–Ω–Ω—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç –≤—Å—Ç—Ä–µ—á–∏), –∫–æ—Ç–æ—Ä—ã–π –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç —Å—Ä–∞–∑—É —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å.
3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏.** –ö–ª–∏–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç `POST /api/memory/save`, –ø–µ—Ä–µ–¥–∞–≤–∞—è `path`, `content` –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ `updateIndex: true`, —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å `index.json`.
4. **–ö–æ–Ω—Ç—Ä–æ–ª—å —Ç–æ–∫–µ–Ω–æ–≤.** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–π—Ç–µ `GET /api/memory/token/status`, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ GitHub-—Ç–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.

### End-to-end –ø—Ä–∏–º–µ—Ä

1. **–ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.** ¬´–ü–æ–¥–≥–æ—Ç–æ–≤—å –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –≤—á–µ—Ä–∞—à–Ω–µ–π –≤—Å—Ç—Ä–µ—á–∏ –ø–æ –º–æ–¥—É–ª—é –æ–ø–ª–∞—Ç—ã¬ª.
2. **–í—ã–∑–æ–≤ –ø–ª–∞–≥–∏–Ω–∞ –∑–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º.** –ê–≥–µ–Ω—Ç –≤—ã–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (`–æ–ø–ª–∞—Ç–∞`, `–≤—Å—Ç—Ä–µ—á–∞`, `—Ä–µ–∑—é–º–µ`) –∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
   ```bash
   curl -X POST http://localhost:10000/api/memory/context \
     -H "Content-Type: application/json" \
     -d '{
       "filenames": [
         "memory/context/autocontext-index.md",
         "memory/notes/payments.md"
       ]
     }'
   ```
3. **–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞–º—è—Ç—å.**
   ```json
   {
     "reply": "–ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –≥–æ—Ç–æ–≤–æ: —É—Ç–æ—á–Ω–∏–ª–∏ —Å—Ä–æ–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ —Å–ø–∏—Å–æ–∫ —Ä–∏—Å–∫–æ–≤.",
     "memory_to_save": {
       "path": "memory/notes/meetings/2024-05-12-payments.md",
       "content": "# –í—Å—Ç—Ä–µ—á–∞ –ø–æ –æ–ø–ª–∞—Ç–∞–º (12.05)\n- –°—Ä–æ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: –∫–æ–Ω–µ—Ü –Ω–µ–¥–µ–ª–∏\n- –†–∏—Å–∫–∏: –∑–∞–¥–µ—Ä–∂–∫–∞ API –±–∞–Ω–∫–∞"
     }
   }
   ```
4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `memory_to_save`.**
   ```bash
   curl -X POST http://localhost:10000/api/memory/save \
     -H "Content-Type: application/json" \
     -d '{
       "path": "memory/notes/meetings/2024-05-12-payments.md",
       "content": "# –í—Å—Ç—Ä–µ—á–∞ –ø–æ –æ–ø–ª–∞—Ç–∞–º (12.05)\n- –°—Ä–æ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: –∫–æ–Ω–µ—Ü –Ω–µ–¥–µ–ª–∏\n- –†–∏—Å–∫–∏: –∑–∞–¥–µ—Ä–∂–∫–∞ API –±–∞–Ω–∫–∞",
       "updateIndex": true
     }'
   ```
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞.**
   ```bash
   curl http://localhost:10000/api/memory/token/status
   # -> { "connected": true }
   ```


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤

- **Windows**:
  ```powershell
  chcp 65001
  PowerShell -ExecutionPolicy Bypass -File scripts\install_model.ps1
  ```
- **Linux/macOS**:
  ```bash
  ./scripts/install_model.sh
  ```

### –†—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –º–æ–¥–µ–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è bartowski](https://huggingface.co/bartowski) —Å –ø–æ–º–æ—â—å—é `wget` –∏–ª–∏ PowerShell:

```bash
wget https://huggingface.co/bartowski/<MODEL>/resolve/main/<FILE> -O models/<FILE>
```

```powershell
chcp 65001
Invoke-WebRequest -Uri "https://huggingface.co/bartowski/<MODEL>/resolve/main/<FILE>" -OutFile "models/<FILE>"
```

### –°–æ–≤–µ—Ç—ã –ø–æ –∫–æ–¥–∏—Ä–æ–≤–∫–µ

- –í—ã–ø–æ–ª–Ω–∏—Ç–µ `chcp 65001` –≤ PowerShell, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ UTF-8.
- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –∫–æ–º–∞–Ω–¥–æ–π `Set-Content -Encoding UTF8`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∏—Å–∫–∞–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–æ–≤.

### –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

- **–ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π**: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ UTF-8 –∏ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —ç—Ç–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–µ.
- **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã**: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `wget` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Invoke-WebRequest`/`curl`, –µ—Å–ª–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è.

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

–í—Å–µ unit-—Ç–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π:
```bash
npm test
```

## –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–π–Ω—Ç—ã

–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `openapi.yaml` –∏ –¥–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ `GET /docs` –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. –ù–∏–∂–µ ‚Äî —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã. –î–ª—è –∏–∑–º–µ–Ω—è—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã `POST`/`PUT`; —á—Ç–µ–Ω–∏–µ –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ `GET` –∏–ª–∏ `POST` (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞).

### /api/files ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ –≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–º—è—Ç–∏, –≤–∫–ª—é—á–∞—è GitHub-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
- **–ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã:**
  - `POST /api/files/save` (—Ä–∞–Ω–µ–µ `/save`) ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏–ª–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
  - `POST /api/files/read` (—Ä–∞–Ω–µ–µ `/read`) ‚Äî –≤–µ—Ä–Ω—É—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞.
- **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "path": "memory/notes/summary.md",
    "content": "# –ò—Ç–æ–≥–∏ –≤—Å—Ç—Ä–µ—á–∏\n...",
    "useGithub": true
  }
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
  ```json
  {
    "status": "ok",
    "path": "memory/notes/summary.md"
  }
  ```
- **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –∑–∞–≥—Ä—É–∑–∫–∞/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö –∑–∞–º–µ—Ç–æ–∫, —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –¥—Ä—É–≥–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –Ω–µ –≤—Ö–æ–¥—è—â–∏—Ö –≤ –æ—Å–Ω–æ–≤–Ω—É—é –ø–∞–º—è—Ç—å —É—Ä–æ–∫–æ–≤.

### /api/memory ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –ø–∞–º—è—Ç—å –∏ –∏–Ω–¥–µ–∫—Å
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –ø–∞–º—è—Ç—å—é –∏ –∏–Ω–¥–µ–∫—Å–æ–º (`index.json`).
- **–ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã:**
  - `POST /api/memory/save` –∏ `POST /api/memory/read` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø–∞–º—è—Ç—å—é (–¥—É–±–ª–∏—Ä—É—é—â–∏–µ –ø—É—Ç–∏ `/saveMemory` –∏ `/readMemory` —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç).
  - `POST /api/memory/save-with-index` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å `index.json` (—Ä–∞–Ω–µ–µ `/saveMemoryWithIndex`).
  - `POST /api/memory/load-to-context` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –ø–∞–º—è—Ç–∏ –≤ —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç.
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞:** –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é –≤ GitHub –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ –∏ –Ω–∞–ª–∏—á–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è; –æ—Ç–≤–µ—Ç—ã `401/403` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è ¬´Invalid GitHub token.¬ª/¬´Access denied to repository.¬ª, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã ‚Äî ¬´Repository not found.¬ª, –∑–∞–ø–∏—Å—å –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.
- **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "path": "memory/core/context.md",
    "content": "–ö–ª—é—á–µ–≤—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏...",
    "updateIndex": true
  }
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
  ```json
  {
    "status": "saved",
    "path": "memory/core/context.md",
    "indexUpdated": true
  }
  ```
- **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ —É—Ä–æ–∫–æ–≤, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤.

### /api/lessons ‚Äî –ø–ª–∞–Ω—ã, –æ—Ç–≤–µ—Ç—ã –∏ –≤–µ—Ä—Å–∏–∏
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–µ–±–Ω—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –∏ –≤–µ—Ä—Å–∏—è–º–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.
- **–ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã:**
  - `POST /api/lessons/save-plan` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –ø–ª–∞–Ω –æ–±—É—á–µ–Ω–∏—è (—Ä–∞–Ω–µ–µ `/saveLessonPlan`).
  - `POST /api/lessons/save-answer` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É (—Ä–∞–Ω–µ–µ `/saveAnswer`).
  - `POST /api/lessons/version/commit` –∏ `POST /api/lessons/version/rollback` ‚Äî –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å –≤–µ—Ä—Å–∏—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.
- **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "lessonId": "05",
    "plan": ["–ü–æ–≤—Ç–æ—Ä–∏—Ç—å CSS box model", "–ü—Ä–∞–∫—Ç–∏–∫–∞ –Ω–∞ flex"],
    "comment": "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–¥ —Å–ø—Ä–∏–Ω—Ç–æ–º"
  }
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
  ```json
  {
    "status": "updated",
    "lessonId": "05",
    "version": "1.3"
  }
  ```
- **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –≤–µ–¥–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤ —É—Ä–æ–∫–æ–≤, —Ñ–∏–∫—Å–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è —Å–≤–µ—Ä–∫–∏, –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π –º–µ—Ç–æ–¥–∏—á–µ–∫.

### /api/github ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GitHub
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** —Ä–∞–±–æ—Ç–∞ —Å OAuth-—Ç–æ–∫–µ–Ω–æ–º –∏ —Å–æ–¥–µ—Ä–∂–∏–º—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤.
- **–ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã:**
  - `POST /api/github/repos` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Ç–æ–∫–µ–Ω—É (—Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ –∏ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è).
  - `POST /api/github/repository` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è); –æ—Ç–≤–µ—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–∫–µ–Ω–∞, —Ç–æ–ª—å–∫–æ —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∏ —Å—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–π.
  - `POST /api/github/file` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ª–∏–Ω—Ç–∏–Ω–≥–∞; —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –∏ —Ç–æ–∫–µ–Ω –Ω–µ –ø–∏—à—É—Ç—Å—è –≤ –ª–æ–≥–∏.
- **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "token": "ghp_xxx",
    "owner": "example",
    "repo": "sofia-memory"
  }
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
  ```json
  {
    "files": [{"path": "README.md", "size": 1024}],
    "page": 1,
    "hasNext": false
  }
  ```
- **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ø–µ—Ä–≤–∏—á–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –≤—ã–±–æ—Ä —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –ø–∞–º—è—Ç—å. –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `memory/github`. –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –¥–æ—Å—Ç—É–ø–∞ —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–¥—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –Ω–∏–∂–µ, –ø—Ä–∏ —ç—Ç–æ–º —Ç–æ–∫–µ–Ω –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –∂—É—Ä–Ω–∞–ª—ã.

### –û—à–∏–±–∫–∏ GitHub-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

| –ö–æ–¥ | –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç |
| --- | --- |
| 401 | –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–π GitHub-—Ç–æ–∫–µ–Ω; –∑–∞–ø—Ä–æ—Å –æ—Ç–∫–ª–æ–Ω—ë–Ω –±–µ–∑ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–ø–∏—Å–∏. |
| 403 | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è; –ø—Ä–æ–≤–µ—Ä—å—Ç–µ scope —Ç–æ–∫–µ–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø—ã. |
| 404 | –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ –ø—É—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –ø–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º. |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ GitHub; –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–∑–∂–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. |

### /api/system ‚Äî –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞.
- **–ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã:**
  - `POST /api/system/switch_repo` ‚Äî —Å–º–µ–Ω–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ä–∞–Ω–µ–µ `/setMemoryRepo`).
  - `GET /api/system/profile` ‚Äî –≤–µ—Ä–Ω—É—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (—Ä–∞–Ω–µ–µ `/profile`).
  - `GET /api/system/ping` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (—Ä–∞–Ω–µ–µ `/ping`).
- **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "owner": "example",
    "repo": "sofia-memory"
  }
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
  ```json
  {
    "status": "switched",
    "owner": "example",
    "repo": "sofia-memory"
  }
  ```
- **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏, –±—ã—Å—Ç—Ä—ã–µ health-check, –ø–æ–ª—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞.

## üß† –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ openapi_lite.yaml

–ß—Ç–æ–±—ã GPT –Ω–µ –≤—ã—à–µ–ª –∑–∞ –ø—Ä–µ–¥–µ–ª—ã 30 –æ–ø–µ—Ä–∞—Ü–∏–π, –∏—Å–ø–æ–ª—å–∑—É–π:
```bash
node scripts/generate_openapi_lite.js
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. `config/openapi-lite.config.json`.

## üìÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ OpenAPI

OpenAPI-—Ñ–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `/openapi.yaml`

–î–ª—è —Ä—É—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

```bash
npm run build:openapi
```

–§–∞–π–ª `openapi_template.yaml` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏—Ç–æ–≥–æ–≤—ã–π —Ñ–∞–π–ª.

## –ö–æ–¥—Å—Ç–∞–π–ª

–í –ø—Ä–æ–µ–∫—Ç–µ –¥–æ–ø—É—Å—Ç–∏–º—ã —Ç—Ä–∏ —Å—Ç–∏–ª—è –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è:

- `snake_case`;
- `UPPER_SNAKE_CASE`;
- `–ò_–ú–æ–π_–°—Ç–∏–ª—å`.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ camelCase –∏ –¥—Ä—É–≥–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç—Å—è. –ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–¥–Ω–æ–º—É –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å—Ç–∏–ª–µ–π.

## –†–∞–±–æ—Ç–∞ —Å `index.json`

–£—Ç–∏–ª–∏—Ç—ã –∏–∑ `logic/index_manager.js` –ø–æ–º–æ–≥–∞—é—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤. –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- `validateFilePathAgainstIndex(path)` \u2014 —Å–≤–µ—Ä—è–µ—Ç –ø—É—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –∏–Ω–¥–µ–∫—Å–∞ –∏ –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–∞;
- `getLessonPath(num)` \u2014 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Ç—å —É—Ä–æ–∫–∞ –ø–æ –Ω–æ–º–µ—Ä—É, —Å–æ–∑–¥–∞–≤–∞—è –∑–∞–ø–∏—Å—å –≤–∏–¥–∞ `memory/lessons/lesson_XX.md`, –µ—Å–ª–∏ –µ–µ –µ—â–µ –Ω–µ—Ç.
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –º–µ—Ç–æ–¥—ã `getLessonByNumber`, `getByPath`, `getByTag`, `getNextLesson` –∏ `updateMetadata` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º `index.json`.

–§–æ—Ä–º–∞—Ç `index.json` —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
```json
{
  "lessons": {
    "05": { "title": "Box Model", "path": "memory/lessons/05_box_model.md" }
  },
  "plans": { ... },
  "checklists": { ... }
}
```

### –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä `index.json`

–ù–∏–∂–µ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π, –Ω–æ —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π: —É—Ä–æ–∫, –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∑–∞–º–µ—Ç–∫–∞. –ü–æ–ª—è `tags`, `priority` –∏ `status` –ø–æ–º–æ–≥–∞—é—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

```json
[
  {
    "path": "memory/lessons/01_intro.md",
    "type": "lesson",
    "title": "–£—Ä–æ–∫ 01. –í–≤–µ–¥–µ–Ω–∏–µ",
    "summary": "–ö—Ä–∞—Ç–∫–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –ø–ª–∞–≥–∏–Ω–æ–º –ø–∞–º—è—Ç–∏",
    "tags": ["lesson", "onboarding"],
    "priority": "high",
    "status": "published",
    "context_priority": "high"
  },
  {
    "path": "memory/profile/user.md",
    "type": "profile",
    "title": "–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
    "summary": "–†–æ–ª—å: –∞–Ω–∞–ª–∏—Ç–∏–∫, –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è: –∫—Ä–∞—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã",
    "tags": ["profile", "preferences"],
    "priority": "medium",
    "status": "active",
    "context_priority": "medium"
  },
  {
    "path": "memory/notes/2024-05-15-meeting.md",
    "type": "note",
    "title": "–í—Å—Ç—Ä–µ—á–∞ –ø–æ –æ–ø–ª–∞—Ç–∞–º",
    "summary": "–°–æ–≥–ª–∞—Å–æ–≤–∞–ª–∏ —Å—Ä–æ–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –±–∞–Ω–∫–∞",
    "tags": ["payments", "meeting"],
    "priority": "low",
    "status": "draft",
    "context_priority": "medium"
  }
]
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∏–Ω–¥–µ–∫—Å–∞

–≠–Ω–¥–ø–æ–∏–Ω—Ç `POST /api/memory/save-with-index` (—Å–∏–Ω–æ–Ω–∏–º `POST /saveMemoryWithIndex`) –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–π–ª –∏ —Ç—É—Ç –∂–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å –≤ `index.json`.

```bash
curl -X POST http://localhost:10000/api/memory/save-with-index \
  -H "Content-Type: application/json" \
  -d '{
    "filename": "memory/notes/2024-05-15-meeting.md",
    "content": "# –í—Å—Ç—Ä–µ—á–∞ –ø–æ –æ–ø–ª–∞—Ç–∞–º\n- –°—Ä–æ–∫: –∫–æ–Ω–µ—Ü –Ω–µ–¥–µ–ª–∏\n- –†–∏—Å–∫–∏: –∑–∞–¥–µ—Ä–∂–∫–∞ API –±–∞–Ω–∫–∞",
    "userId": "default"
  }'
```

### –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ñ–∞–π–ª–æ–≤

–§—É–Ω–∫—Ü–∏—è `getContextFilesForKeywords(["–æ–ø–ª–∞—Ç–∞", "–≤—Å—Ç—Ä–µ—á–∞"])` –∏—â–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –≤ `title`/`summary`/`tags`, —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö –ø–æ `priority`/`context_priority` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—É—Ç–µ–π.

```js
const { getContextFilesForKeywords } = require('./logic/index_manager');

const files = getContextFilesForKeywords(["–æ–ø–ª–∞—Ç–∞", "–≤—Å—Ç—Ä–µ—á–∞"]);
// –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: [
//   "memory/lessons/01_intro.md",
//   "memory/notes/2024-05-15-meeting.md"
// ]
```

### –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –ø—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –∞ –∫–æ–≥–¥–∞ `multi_index`

- **–ü—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ (`index.json` –∫–∞–∫ –º–∞—Å—Å–∏–≤):** –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –ø–∞–º—è—Ç–∏ (–¥–µ—Å—è—Ç–∫–∏‚Äì—Å–æ—Ç–Ω–∏ —Ñ–∞–π–ª–æ–≤), –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∑–∞–ø–∏—Å–∏ –∏ —á—Ç–µ–Ω–∏—è. –ü–æ–ª—è `priority`/`status`/`tags` —É–∂–µ –ø–æ–∑–≤–æ–ª—è—é—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏.
- **`multi_index`:** –≤–∫–ª—é—á–∞–µ—Ç –∫–æ—Ä–Ω–µ–≤–æ–π `index.json` —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –≤–µ—Ç–∫–∏ (`memory/multi_index/...`). –ù—É–∂–µ–Ω –ø—Ä–∏ —Ç—ã—Å—è—á–∞—Ö —Ñ–∞–π–ª–æ–≤, –∫–æ–≥–¥–∞ —Ö–æ—á–µ—Ç—Å—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—É—Ä–æ–∫–∏, –ø—Ä–æ—Ñ–∏–ª–∏, –ø–ª–∞–Ω—ã) –∏ –¥–µ—Ä–∂–∞—Ç—å –∫–∞–∂–¥—ã–π –∏–Ω–¥–µ–∫—Å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏.

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∏–Ω–¥–µ–∫—Å–∞—Ç–æ—Ä

–ú–æ–¥—É–ª—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π (–Ω–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ª–∏, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –≤–Ω—É—Ç—Ä–∏ `memory/`), —É–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã, –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (`priority`/`context_priority`), –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç `type` –ø–æ –ø—É—Ç–∏ —Ñ–∞–π–ª–∞, —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å–∏ (—Å–Ω–∞—á–∞–ª–∞ `high`, –∑–∞—Ç–µ–º `medium`, –∑–∞—Ç–µ–º `low`) –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–µ–ª–∏—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –Ω–∞ —á–∞—Å—Ç–∏, –¥–æ–±–∞–≤–ª—è—è –∏—Ö –≤ –∏–Ω–¥–µ–∫—Å.

–≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–æ—â–∞—é—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –ø–æ—è–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

### –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ò–Ω–¥–µ–∫—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ –ø–æ–ª—é `priority`: —Å–Ω–∞—á–∞–ª–∞ `high`, –∑–∞—Ç–µ–º `medium`, –∑–∞—Ç–µ–º `low`.
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏: `filterByStatus`, `filterByTags`, `filterByDate`, `filterByCategory`.
- –î–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `searchByKeyword`.
- `getContextFilesForKeywords` –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–¥–æ–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–º—ã –¥–∏–∞–ª–æ–≥–∞.
- –í—ã–∑–æ–≤ `sortIndexByPriority()` –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø–∏—Å–µ–π –≤ `index.json`.
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã —Å `context_priority: high` –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç. –ö–æ–º–∞–Ω–¥–∞ `–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ <file>` –∑–∞–≥—Ä—É–∂–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é.
- –§–∞–π–ª `memory/context/autocontext-index.md` –∑–∞–¥–∞—ë—Ç —Å–ø–∏—Å–æ–∫ –≤–∞–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –ï—Å–ª–∏ –≤ –Ω—ë–º —É–∫–∞–∑–∞–Ω `context_priority: high`, —Ñ–∞–π–ª—ã –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ `files` –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ. –ö–æ–º–∞–Ω–¥–∞ `–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ autocontext-index.md` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç—É –æ–ø–µ—Ä–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é.
- `checkAndRestoreContext(stage, tokens)` —Å–ª–µ–¥–∏—Ç –∑–∞ –ª–∏–º–∏—Ç–æ–º —Ç–æ–∫–µ–Ω–æ–≤ –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–æ—Ä–∏–∏ –∏–ª–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏.
- `getTokenCounter()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –∏ –ª–∏–º–∏—Ç, –∞ `formatTokenCounter(true)` –≤—ã–≤–æ–¥–∏—Ç —Å—Ç—Ä–æ–∫—É –≤–∏–¥–∞ `[–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ] –¢–æ–∫–µ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: 1200/3000 (40%) | –û—Å—Ç–∞–ª–æ—Å—å: 1800`.


### –ú–∏–≥—Ä–∞—Ü–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –ø–∞–º—è—Ç–∏

–ù–æ–≤–∞—è —É—Ç–∏–ª–∏—Ç–∞ `tools/memory_migrator.js` –ø–æ–º–æ–≥–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ñ–∞–π–ª—ã —Å—Ç–∞—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∏—Ö –∫ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–µ. –§—É–Ω–∫—Ü–∏–∏ API:

- `migrateMemoryFile(path)` \u2014 –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π Markdown-—Ñ–∞–π–ª, –¥–æ–±–∞–≤–ª—è—è —Ñ—Ä–æ–Ω—Ç–º–∞—Ç—Ç–µ—Ä –∏ —è–∫–æ—Ä—è;
- `migrateAllLegacyFiles(dir)` \u2014 —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å –ø–∞–º—è—Ç—å—é.

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–µ `migrated: true`, —Ñ–∞–π–ª –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –∏–Ω–¥–µ–∫—Å –∏ –ø–æ–ª—É—á–∞–µ—Ç –≤–µ—Ä—Å–∏—é `1.2`.

### –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω–¥–µ–∫—Å–∞

–ú–æ–¥—É–ª—å `logic/index_validator.js` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ `index.json`.
–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–Ω–¥–µ–∫—Å–∞ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è:

- –ø—É—Ç—å –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–∞–ª–æ–≥–∞ `memory/`;
- –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `fs.existsSync`;
- —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–∞–π–ª—ã –ø–ª–∞–≥–∏–Ω–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

–ù–µ–≤–µ—Ä–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ `pinned: true`),
–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –æ—Ç–º–µ—á–∞—é—Ç—Å—è –≤ –æ—Ç—á—ë—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è –∑–∞–¥–∞—é—Ç—Å—è –≤

`indexSettings` –∏ –≤–∫–ª—é—á–∞—é—Ç –æ—á–∏—Å—Ç–∫—É –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø—É—Ç–µ–π
–ø–ª–∞–≥–∏–Ω–∞.

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤

Markdown-–¥–æ–∫—É–º–µ–Ω—Ç—ã –æ–±—ä—ë–º–æ–º –±–æ–ª–µ–µ **5¬†–ú–ë** –∏ —Ñ–∞–π–ª—ã –∏–Ω–¥–µ–∫—Å–∞ —Å–≤—ã—à–µ **3¬†–ú–ë**
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–∏. –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è –≤
`index.md` –∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `index.json` –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏.

### –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `index.json`

–§–æ–ª–¥–µ—Ä `memory/multi_index` —Å–æ–¥–µ—Ä–∂–∏—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É –∏–Ω–¥–µ–∫—Å–∞, –≥–¥–µ –≥–ª–∞–≤–Ω—ã–π `index.json` —Ö—Ä–∞–Ω–∏—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –∏ –∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ. –ü—Ä–∏–º–µ—Ä –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —Ñ–∞–π–ª–∞:

```json
{
  "lessons": {
    "index": "multi_index/lessons/index.json",
    "metadata": { "sort_order": 1, "search_priority": "high" }
  }
}
```

–í –¥–æ—á–µ—Ä–Ω–∏—Ö –∏–Ω–¥–µ–∫—Å–∞—Ö —ç–ª–µ–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç –±–ª–æ–∫ `metadata` —Å –ø–æ–ª—è–º–∏ `sort_order`, `search_priority`, `category` –∏ `sub_category`. –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ `searchInIndex(query, indexFile)` –æ—Ç–¥–∞—ë—Ç –º–∞–∫—Å–∏–º—É–º –¥–µ—Å—è—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–Ω–¥–µ–∫—Å–∞.


### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ –ø–∞–º—è—Ç–∏

–≠–Ω–¥–ø–æ–π–Ω—Ç—ã `/api/switch_memory_repo` –∏ `/api/status` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è Desktop Agent –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–∞–º—è—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–∂–∏–º–∞.

- `GET /api/switch_memory_repo` ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º —Ö—Ä–∞–Ω–µ–Ω–∏—è. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `type` (`local` –∏–ª–∏ `github`) –∏ `userId`.
- `GET /api/status` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ `userId`.

Desktop Agent –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/api/switch_memory_repo` –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–∏ –∏–ª–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ GitHub. –ó–∞—Ç–µ–º –æ–Ω –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç `/api/status`, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ä–µ–∂–∏–º —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á—ë–Ω.

```bash
# –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–∞–ø–∫—É
curl "http://localhost:10000/api/switch_memory_repo?type=local&userId=123"

# —É–∑–Ω–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º
curl "http://localhost:10000/api/status?userId=123"
```

### –ú–∏–Ω–∏—á–∞—Ç –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–∞

–ö–æ–º–∞–Ω–¥–∞ `/regenerate` –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–ª–∞–≥–∏–Ω –≤ —Ä–µ–∂–∏–º –º–∏–Ω–∏—á–∞—Ç–∞, –≥–¥–µ –º–æ–∂–Ω–æ
—É—Ç–æ—á–Ω—è—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É –∏ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ —Ä–∞–∑.
–î–æ—Å—Ç—É–ø–Ω—ã –∫–æ–º–∞–Ω–¥—ã `/accept` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞,
`/reject` –¥–ª—è –ø–æ–ø—ã—Ç–∫–∏ —Å –Ω–æ–≤–æ–π –ø–æ–¥—Å–∫–∞–∑–∫–æ–π –∏ `/cancel` –¥–ª—è –≤—ã—Ö–æ–¥–∞ –±–µ–∑
–∏–∑–º–µ–Ω–µ–Ω–∏–π.

–ü—Ä–∏–º–µ—Ä –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è:

```bash
/regenerate
> —É–ª—É—á—à–∏—Ç—å —Å—Ç–∏–ª—å –æ—Ç–≤–µ—Ç–∞
/accept
```

## Mirror Neurons

Mirror Neurons –ø–æ–∑–≤–æ–ª—è—é—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∏–ª—å, —Å—Ç—Ä—É–∫—Ç—É—Ä—É
–∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–Ω –≤—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞. –ö–∞–∂–¥—ã–π –Ω–µ–π—Ä–æ–Ω –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ—Ä –∏
–¥–æ–±–∞–≤–ª—è–µ—Ç —Å–≤–æ–π –≤–∫–ª–∞–¥ –≤ –∏—Ç–æ–≥–æ–≤—ã–π —á–µ—Ä–Ω–æ–≤–æ–π –æ—Ç–≤–µ—Ç.

### –ü—Ä–∏–º–µ—Ä –≤–∫–ª—é—á–µ–Ω–∏—è

–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—ã–µ –º–æ–¥—É–ª–∏ –≤ `config/config.json`:

```json
{
  "mirrorNeurons": ["StyleMirrorNeuron", "EmotionMirrorNeuron"]
}
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–∞—Ö —Å–º. –≤
[`docs/mirror-neurons.md`](docs/mirror-neurons.md).

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–æ–≤ –ø–µ—Ä–µ–¥–∞–π—Ç–µ –æ–±—Ä–∞–∑–µ—Ü —Ç–µ–∫—Å—Ç–∞ –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —á–µ—Ä–Ω–æ–≤–∏–∫–∞:

```js
const generator = new DraftGenerator(config);
const draft = await generator.generate({
  sample: "–≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç –∑–∞–¥–∞—ë—Ç —Å—Ç–∏–ª—å.",
  prompt: "–û—Ç–≤–µ—Ç—å –≤ —Ç–æ–º –∂–µ —Å—Ç–∏–ª–µ"
});
```

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —á–µ—Ä–Ω–æ–≤–∏–∫ –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å —Å—Ç–∏–ª—å –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç—Ç–µ–Ω–æ–∫
–æ–±—Ä–∞–∑—Ü–∞.

