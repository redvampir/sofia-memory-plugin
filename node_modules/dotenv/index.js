const fs = require('fs');
function config(options = {}) {
  const path = options.path || '.env';
  if (!fs.existsSync(path)) return { parsed: {} };
  const result = {};
  const data = fs.readFileSync(path, 'utf-8');
  data.split(/\r?\n/).forEach(line => {
    const m = line.match(/^\s*([A-Za-z0-9_.-]+)\s*=\s*(.*)\s*$/);
    if (m) {
      let value = m[2] || '';
      if (value.startsWith('"') && value.endsWith('"')) {
        value = value.slice(1, -1);
      }
      if (process.env[m[1]] === undefined) {
        process.env[m[1]] = value;
      }
      result[m[1]] = value;
    }
  });
  return { parsed: result };
}
module.exports = { config };
