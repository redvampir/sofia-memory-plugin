openapi: 3.1.0
info:
  title: Sofia Memory API
  version: 1.0.0
  description: >-
    Минимальное описание публичных методов памяти Софии для интеграции
    внешних сервисов.
servers:
  - url: https://example.com
    description: Заменить на Render URL после деплоя
paths:
  /ping:
    get:
      summary: Проверка доступности сервиса
      description: Быстрый health-check; при успешной работе возвращает строку «pong».
      responses:
        '200':
          description: Сервис отвечает и готов принимать запросы.
          content:
            text/plain:
              schema:
                type: string
                example: pong
  /api/memory/save:
    post:
      summary: Сохранение памяти пользователя
      description: >-
        Записывает текстовое содержимое в память пользователя по указанному пути.
        В опциональном объекте meta можно передавать дополнительные атрибуты (ключ-значение).
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, path, content]
              properties:
                userId:
                  type: string
                  description: Уникальный идентификатор пользователя.
                path:
                  type: string
                  description: Логический путь или ключ записи.
                content:
                  type: string
                  description: Сохраняемый текст.
                meta:
                  type: object
                  additionalProperties: true
                  description: Произвольные метаданные (опционально).
      responses:
        '200':
          description: Запись сохранена.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
                  savedPath:
                    type: string
                    description: Итоговый путь сохранённой записи.
  /api/memory/read:
    post:
      summary: Чтение памяти пользователя
      description: Возвращает содержимое записи по userId и path.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, path]
              properties:
                userId:
                  type: string
                  description: Уникальный идентификатор пользователя.
                path:
                  type: string
                  description: Путь ранее сохранённой записи.
      responses:
        '200':
          description: Найденная запись.
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: string
                    description: Хранимый текст.
                  meta:
                    type: object
                    additionalProperties: true
                    description: Сохранённые метаданные (если есть).
        '404':
          description: Запись не найдена.
